<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>recorder</title>
</head>
<body>
<button onclick="startRecorder()">Start Recorder</button>
<button onclick="finishAndPlay()">finish and play</button>
</body>
<script src="../libs/Recorder/recorder.mp3.min.js"></script>
<script>
  // https://github.com/xiangyuecn/Recorder
  let rec;

  function startRecorder() {
    rec = Recorder({type: 'mp3', sampleRate: 16000, bitRate: 30});
    rec.open(function () {
      rec.start();
    }, function (msg, isUserNotAllow) {
      alert((isUserNotAllow ? '用户拒绝了权限，' : '') + '无法录音:' + msg);
    });
  }

  function finishAndPlay() {
    rec.stop(function (blob, duration) {
      let audio = document.createElement('audio');
      audio.controls = true;
      document.body.appendChild(audio);
      audio.src = URL.createObjectURL(blob);
      audio.play();
    }, function (msg) {
      alert('录音失败:' + msg);
    });
  }
</script>
</html>